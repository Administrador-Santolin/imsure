<div class="page-container">
    <mat-card>
        <mat-card-header>
            <mat-card-title>
                <div class="header-content">
                    <div class="title-section">
                        <mat-icon>business</mat-icon>
                        <h2>{{ isEditing ? 'Editar Seguradora' : 'Nova Seguradora' }}</h2>
                    </div>
                </div>
            </mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <form [formGroup]="seguradoraForm">

                <div class="formGrid">
                    <mat-form-field appearance="fill">
                        <mat-label>Nome</mat-label>
                        <input matInput formControlName="nome" required />
                        @if (seguradoraForm.get('nome')?.hasError('required') && seguradoraForm.get('nome')?.touched) {
                        <mat-error>Nome é obrigatório</mat-error>
                        }
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>CNPJ</mat-label>
                        <input matInput formControlName="cnpj" required mask="00.000.000/0000-00" />
                        @if (seguradoraForm.get('cnpj')?.hasError('required') && seguradoraForm.get('cnpj')?.touched) {
                        <mat-error>CNPJ é obrigatório</mat-error>
                        }
                        @if (seguradoraForm.get('cnpj')?.hasError('cnpjInvalido')) {
                        <mat-error>CNPJ inválido</mat-error>
                        }
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>Contato Comercial</mat-label>
                        <input matInput formControlName="contatoComercial" />
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>Telefone</mat-label>
                        <input matInput formControlName="telefone" mask="(00) 00000-0000 || (00) 0000-0000" />
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>Email</mat-label>
                        <input matInput formControlName="email" type="email" />
                        @if (seguradoraForm.get('email')?.hasError('email') && seguradoraForm.get('email')?.touched) {
                        <mat-error>Email inválido</mat-error>
                        }
                    </mat-form-field>
                </div>
            </form>
        </mat-card-content>
        <mat-card-actions>
            <div class="form-actions">
                <button matButton (click)="onCancel()" [disabled]="isLoading">Cancelar</button>
                <button matButton="filled" (click)="onSubmit()"
                    [disabled]="isEditing ? seguradoraForm.invalid || seguradoraForm.pristine: seguradoraForm.invalid || isLoading">
                    {{ isEditing ? 'Atualizar' : 'Salvar' }}
                </button>
            </div>
        </mat-card-actions>
    </mat-card>
</div>